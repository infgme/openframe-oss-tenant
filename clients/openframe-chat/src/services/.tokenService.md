<!-- source-hash: ab7af06e16cfac6ecdf4afd3783373b5 -->
A singleton service that manages authentication tokens and API URLs for a Tauri desktop application, handling communication between the frontend and Rust backend for secure token storage and retrieval.

## Key Components

- **TokenService**: Main singleton class that manages authentication state
- **tokenService**: Exported singleton instance for application-wide use
- **Token Management**: Secure token storage, retrieval, and updates via Tauri commands
- **API URL Management**: Dynamic server URL configuration and normalization
- **Event Listeners**: Real-time token and URL updates from Rust backend
- **Subscription System**: Observable pattern for components to react to auth changes

## Usage Example

```typescript
import { tokenService } from './tokenService';

// Get current authentication state
const token = tokenService.getCurrentToken();
const apiUrl = tokenService.getCurrentApiBaseUrl();

// Subscribe to token updates
const unsubscribe = tokenService.onTokenUpdate((newToken) => {
  console.log('Token updated:', newToken);
  // Update HTTP client headers, etc.
});

// Subscribe to API URL changes
const unsubscribeUrl = tokenService.onApiUrlUpdate((newUrl) => {
  console.log('API URL updated:', newUrl);
  // Reconfigure HTTP client base URL
});

// Ensure authentication is ready before making API calls
await tokenService.ensureTokenReady();

// Request fresh token from Rust backend
const freshToken = await tokenService.requestToken();

// Clean up subscriptions
unsubscribe();
unsubscribeUrl();
```

The service automatically initializes from environment variables (`VITE_TOKEN`, `VITE_SERVER_URL`) and maintains persistent connections to the Rust backend via Tauri's event system for secure credential management in desktop applications.