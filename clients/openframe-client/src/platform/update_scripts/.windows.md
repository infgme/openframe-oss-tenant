<!-- source-hash: 113e8dcb32b2704b2ab4336c683a39c6 -->
PowerShell script module that provides self-update functionality for Windows services, handling executable replacement with automatic rollback on failure.

## Key Components

- **UPDATE_SCRIPT_WINDOWS** - Complete PowerShell script constant for Windows service updates
- **Service Management** - Automated service stop/start with timeout handling
- **File Operations** - Archive extraction, backup creation, and atomic executable replacement
- **Error Handling** - Comprehensive error checking with automatic rollback functionality
- **Validation** - Input validation and file integrity checks before update execution

## Usage Example

```rust
use std::process::Command;
use std::fs;

// Execute the Windows update script
fn run_windows_update(archive_path: &str, service_name: &str, target_exe: &str, state_path: &str) -> Result<(), Box<dyn std::error::Error>> {
    // Write script to temporary file
    let script_path = "temp_update.ps1";
    fs::write(script_path, UPDATE_SCRIPT_WINDOWS)?;
    
    // Execute PowerShell script with parameters
    let output = Command::new("powershell.exe")
        .arg("-ExecutionPolicy")
        .arg("Bypass")
        .arg("-File")
        .arg(script_path)
        .arg("-ArchivePath")
        .arg(archive_path)
        .arg("-ServiceName")
        .arg(service_name)
        .arg("-TargetExe")
        .arg(target_exe)
        .arg("-UpdateStatePath")
        .arg(state_path)
        .output()?;
    
    if !output.status.success() {
        return Err(format!("Update failed: {}", String::from_utf8_lossy(&output.stderr)).into());
    }
    
    // Cleanup script file
    fs::remove_file(script_path)?;
    Ok(())
}
```

The script provides robust Windows service updating with comprehensive error handling, automatic backup creation, and rollback capabilities to ensure system stability during updates.