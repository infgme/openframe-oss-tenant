<!-- source-hash: 9619cf29a5c82369af57dff85e590a87 -->
This hook provides comprehensive chat functionality for the Flamingo MSP platform, managing real-time messaging, NATS streaming, and dialog state with advanced features like message approvals and chunk processing.

## Key Components

- **Message Management**: Handles user/assistant messages with real-time updates and approval workflows
- **NATS Integration**: Real-time streaming via WebSocket connections with subscription management
- **Dialog Resume**: Capability to resume previous conversations by loading historical messages
- **Chunk Processing**: Processes streaming message chunks with catchup functionality for missed content
- **Approval System**: Manages escalated approvals for commands requiring user consent
- **Error Handling**: Comprehensive error states with user-friendly messaging
- **Token Management**: Automatic API token and base URL management via tokenService

## Usage Example

```typescript
import { useChat } from './useChat'

function ChatInterface() {
  const {
    messages,
    isTyping,
    isStreaming,
    error,
    dialogId,
    sendMessage,
    handleQuickAction,
    clearMessages,
    resumeDialog
  } = useChat({
    useApi: true,
    useNats: true,
    onMetadataUpdate: (metadata) => {
      console.log('Model info:', metadata.modelName, metadata.providerName)
    }
  })

  const handleSend = async (text: string) => {
    await sendMessage(text)
  }

  const handleResume = async (dialogId: string) => {
    const success = await resumeDialog(dialogId)
    if (success) {
      console.log('Dialog resumed successfully')
    }
  }

  return (
    <div>
      {messages.map(msg => (
        <div key={msg.id}>{msg.content}</div>
      ))}
      {isTyping && <div>Fae is typing...</div>}
      {error && <div>Error: {error}</div>}
    </div>
  )
}
```

The hook integrates multiple services including chunk catchup, message management, and approvals to provide a complete chat experience with real-time capabilities and state persistence.