registerJob:
  enabled: true
  image:
    registry: ghcr.io/flamingo-stack/registry
    repository: curlimages/curl
    tag: "8.9.1"


prometheus:
  server:
    image:
      repository: ghcr.io/flamingo-stack/registry/prometheus/prometheus
      tag: v3.7.3
    podAnnotations:
      loki.grafana.com/scrape: "true"

    # 25 days retention
    retention: "25d"

    # Resources
    resources:
      requests:
        cpu: 500m
        memory: 1Gi
      limits:
        cpu: 1
        memory: 2Gi

    persistentVolume:
      enabled: true
      existingClaim: "prometheus"

    # Enable remote write receiver for Alloy
    extraFlags:
      - "web.enable-remote-write-receiver"
      - "web.enable-lifecycle"
      - "storage.tsdb.retention.size=17GB" 

    # Global settings
    global:
      scrape_interval: 30s
      scrape_timeout: 10s
      evaluation_interval: 30s

  # Disable sub-charts - Alloy handles collection
  prometheus-node-exporter:
    enabled: false

  kube-state-metrics:
    enabled: false

  alertmanager:
    enabled: false

  prometheus-pushgateway:
    enabled: false

  # Prometheus configuration
  serverFiles:
    prometheus.yml:
      # Enable out-of-order ingestion for remote write
      storage:
        tsdb:
          out_of_order_time_window: 10m

      scrape_configs:
        - job_name: prometheus
          static_configs:
            - targets:
                - localhost:9090
