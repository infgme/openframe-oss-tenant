<!-- source-hash: f01643aae7d5ff5f1fd8187c8b4b8b5e -->
Windows file lock detection utility using the Restart Manager API to identify processes that have files open. Provides detailed error reporting for file sharing violations on Windows systems.

## Key Components

- **`LockingProcess`** - Struct containing process ID and name of processes locking files
- **`get_locking_processes()`** - Core function that queries Windows Restart Manager API to find processes with file handles
- **`format_locking_processes()`** - Formats process list into human-readable string
- **`is_file_in_use_error()`** - Checks if an IO error is specifically a sharing violation (error code 32)
- **`log_file_lock_info()`** - High-level function that detects file lock errors and logs detailed process information

## Usage Example

```rust
use std::fs::File;
use file_lock::{log_file_lock_info, get_locking_processes};

// Check which processes are locking a file
match get_locking_processes("C:\\temp\\locked_file.txt") {
    Ok(processes) => {
        for process in processes {
            println!("File locked by: {}", process); // Displays "notepad.exe (PID: 1234)"
        }
    }
    Err(e) => eprintln!("Failed to query file locks: {}", e),
}

// Automatic error handling with logging
match File::open("locked_file.txt") {
    Err(e) => {
        if log_file_lock_info(&e, "locked_file.txt", "open") {
            // Error was handled and logged with process details
        } else {
            // Handle other types of errors
        }
    }
    Ok(file) => { /* use file */ }
}
```

The module uses Windows Restart Manager API with proper RAII cleanup via `SessionGuard` and handles the expected `ERROR_MORE_DATA` response pattern for querying process counts.