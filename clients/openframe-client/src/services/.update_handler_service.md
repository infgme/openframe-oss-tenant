<!-- source-hash: 74f45bc0c00dadb95cec0d267a00cf3c -->
Orchestrates the handling of pending software updates by managing state transitions, client information updates, and cleanup operations.

## Key Components

- **UpdateHandlerService** - Main service that coordinates update processing workflows
- **handle_pending_update()** - Entry point that checks for pending updates and routes to success/failure handlers
- **handle_success()** - Processes successful updates by updating client info, sending notifications, and cleaning up
- **handle_failure()** - Handles failed updates by marking status and performing cleanup
- **send_nats_notification()** - Publishes update completion events to NATS messaging system with retry logic

## Usage Example

```rust
use update_handler_service::UpdateHandlerService;

// Initialize the service with dependencies
let handler = UpdateHandlerService::new(
    state_service,
    client_info_service,
    cleanup_service,
    installed_agent_publisher,
    config_service,
);

// Process any pending updates
handler.handle_pending_update().await?;
```

The service automatically detects whether an update succeeded or failed by comparing the current client version against the target version from the update state. It handles all post-update tasks including version tracking, status updates, NATS notifications with retry logic, and cleanup operations.