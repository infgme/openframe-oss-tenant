<!-- source-hash: 68a05b571ff47310b6169b81d469deb5 -->
Manages the connection processing lifecycle for installed tools, executing agent ID commands and publishing connection messages with retry logic.

## Key Components

- **ToolConnectionProcessingManager** - Main orchestrator that processes tool connections asynchronously
- **run()** - Processes all installed tools that don't have existing connections
- **run_new_tool()** - Handles connection processing for newly installed tools
- **process_tool()** - Core processing logic that executes agent ID commands and publishes connection messages
- **try_mark_running()** - Prevents duplicate processing using a concurrent-safe running tools registry

## Usage Example

```rust
use crate::tool_connection_processing_manager::ToolConnectionProcessingManager;

// Initialize the manager with required services
let manager = ToolConnectionProcessingManager::new(
    installed_tools_service,
    params_processor,
    tool_connection_publisher,
    config_service,
    tool_connection_service,
);

// Process all installed tools
manager.run().await?;

// Or process a specific newly installed tool
manager.run_new_tool(installed_tool).await?;

// Clear running state when done
manager.clear_running_tool("tool_id").await;
```

The manager spawns async tasks for each tool, executing their agent ID commands with 15-second timeouts, publishing connection messages, and persisting connection records. It includes comprehensive retry logic with 15-second delays and prevents concurrent processing of the same tool using a thread-safe HashSet.